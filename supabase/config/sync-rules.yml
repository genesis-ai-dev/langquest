bucket_definitions:
  global_bucket:
    data:
      #   Sync all rows-- Select all data from User table
      - SELECT * FROM "profile"
      #   Sync all languages globally so they're available for project creation
      - SELECT * FROM "language" WHERE active = true
      - SELECT * FROM "tag" WHERE project_id is null
        # - SELECT * FROM "tag" WHERE project_id is null and id in ('a7cb49c5-fec8-4a88-826b-9efda833323f','29e6d656-9355-4bc7-b29a-65f67932c545','b57aa52a-885c-403e-bb30-0c87a61b8859','fe998bb3-b1c8-4b43-8a15-c709d94f34a5','f18e8e84-1a10-49b3-b665-22ed5234742f','ddb5fc29-e8be-4f9d-9c2d-c0406895096e','08ab8370-796c-47f9-8671-54cc0db65635','37b3882e-2bbf-4ea7-8e28-df7146430cd7','3f0d6168-e699-403f-bb9d-a3bb9eb064e1','6d85d140-7bd6-4d0b-bc77-06f8463483d5','d4d6981b-64d4-4a3c-a1c2-af8813c97958','2c4c000b-b4b6-4159-a860-411f63fb372b','000cdc6a-4204-4808-bdae-1b2efddc882e','78d5b9d1-78c1-4571-9a7b-dc5d43c5696e','f632caca-203a-456a-9713-a3f34f9576b6','96bda148-75cb-4d46-90e1-23dde7d01b39','479ac310-2b37-4850-b0f9-60fc65bb2cc4','01cca680-02be-4513-b96c-552e82cd44f6','75563e79-674a-4b66-b144-9b5c96455656','fec55b08-c144-45ae-a85a-17e12f5372db','4d303fb1-1de2-4a8e-9bd1-d61771ec6a75','24a41281-1ef0-41ce-9852-ec564e6c23a3','e61ab6ff-6590-41cd-b811-0cbe6d54b26d','8af1823e-a44a-42c1-83b6-f4c914c6c0ba','a0850f5c-848c-4c74-8b15-0d7874f334d7','2054dccd-f4ef-47fb-8626-5033b9e4f344','bf42e1b4-d72c-46de-b07b-afdadc2cbbc3','6995a5f2-ad9c-4328-ae8a-388b3ffe212c','1ccd82ae-b606-4d89-b5fc-2986128956d9','02548edf-de68-4ed5-b6b6-f15aad72a69b','8f702ab4-7317-49b6-8068-c04d9cad3d66','a22831bd-b5cd-42d2-95ab-aef81797cb81','eeb1602f-6643-4e58-847c-72b28d4fbdda','82e57368-0b91-455a-a13c-86344793e78e','b0f57ee0-0148-492c-b166-9cd0124fac70','e347d88d-c4e9-4cf4-812a-66a052ffd6c6','7c1c3674-d613-4073-bb1e-12cc604e0924','9611f4d9-e67a-43b2-9afd-0ea48198e10b','ab6eb708-93fd-4bfa-9bf3-af70ff602a83','8046decc-7c83-4a14-ac7e-a895ff405a17','2a07e140-9881-4b5f-84ed-cec4554b9970','768fcc4a-efce-4572-8302-ece0882db429','16cfff52-0ca5-40af-bb9d-70d4a1d1b42f','7ea2a933-4aed-4479-ba0b-6447b770963c','567a76bb-48ed-48bc-a751-9372ef2b70c0','a8feed06-4e80-48c7-9d8f-1402a19ce782','2a1cf296-78f0-4be2-977d-0bb0921e8d6d','0e48100c-d985-440b-aa0e-437f09eff5fe','6b85df7c-5adc-46f7-906b-7388fcb30687','e373e085-13e0-4286-88b0-9db9f93dc5e3','369ab182-90ab-4336-81ca-4c6b3e629de6','86305cf1-3623-429f-9ac9-52af253f172a','d521b1e6-d09a-4cf2-80e8-7c8ec267de30','eca46de7-52b1-48e8-a1f6-8bb9c4977c2a','120a30e4-e2e5-46c0-bd82-156a17ed2a6d','4edeec2d-71f2-407e-9e6a-a6264f11f97d','dd49768d-377b-42f2-84f6-a08731cec53e','3c77f625-68d1-4eb0-ae91-620568663923','e6cb5de5-979c-4980-a534-c1ff79a5de23','572495c2-62f3-4d04-886b-05b53018c016','ae09ec56-bb37-411c-bdcb-c5a6172c4594','271f404d-8b97-4944-9bc8-872d15ae81ef','0d93b346-d3f5-4a44-859c-1326c47ccbc2','091153c0-98cf-45a7-8eef-0a5d8eefaa8c','12912484-d8ca-4121-89ba-575525c51082','94b20c2d-3d91-40de-a4df-eef9822df2f5','01a643aa-1406-44cf-8173-ef7de8f22c3f','cac03b7e-d736-4092-a5a6-fdd6593d9f05','b50c92ec-1bd4-4bae-b892-e9660e2aecde','f470498d-58ce-48c4-a5a8-dccf93cf59ec','e011e262-6ebe-4268-9d31-cfa1db792798','63b6ed80-4eb8-4655-92f4-38680019f709','9f5a0c0d-9829-40e9-82d2-0c551d2cf9b0','464969b1-7eb8-4c47-8147-a8579e9caf4b','ec6d34d0-66a1-4a36-9a89-6100b2974ac3','92d3d620-2eb5-4bf6-b89c-0fec53e50673','6fd981a2-d7b4-454b-9eb2-6d0fb472c236','ef57203b-9735-4cf0-98a3-47b00b72775c','abf7b953-d39e-4fd7-8e2b-877b65c96541','ed9dabbd-6831-4df2-a5ca-66640604f8b1','cc85ed2c-8ce2-468b-8a8d-7c3cac5d893a','56496e7d-9353-4ab2-8fc7-6825bec1ccf5','f4bf4e0a-ad4c-4b24-b4a7-19370e952ff4','8923d52e-9b8f-413a-9b56-1acc225d8ed4','5914d5a5-e3d0-4450-9dbf-8c2b7ddd65e9','bf5cd543-4b54-471c-836b-7422ce141965','45c72e28-e6aa-41dd-91f3-eebd22089467','8deddf0f-b18f-4246-8894-d50741bb1d2d','18e605b5-1ed6-4f4c-a7c1-f9a25789f19a','a3cf2484-467a-4481-88b4-43ee346a9f95','7eccf2d6-b4ab-4d1a-8d54-7a80734f4732','8308d060-2e76-446b-b72e-78f5129814b2','010d39a2-de7c-4c26-9eb8-be120308263e','4c3f42d8-21b6-4de7-94c0-dc9e4f85dfb5','b4950420-6631-466a-b674-dc41170c0899','c2d221d7-4741-46f0-a3a5-8a89e0d04c37','fd23ca26-fe67-4a4d-ac2e-ffd2f6cfd6fc','27bc38f8-dc3b-448e-b47a-9a44c8f7b7ac','526389b5-889b-4c85-8ee6-6e46b732cd67','600f905a-16fd-4060-8c1b-695c1e943493','b8f89e33-a994-44b1-b08c-a05eb172f271','f5ec9329-75d6-4826-85e1-faeb44a8a297','48091241-56d4-4887-aa5a-3e28f669b6b6','980f23a7-d11e-47c0-a9a1-d6f821f9c2c9','92e87099-c7fa-4429-a0b3-8e709d3be791','faf26374-9d63-4f89-8e00-2c65955d8a5c','7b2b4857-0a99-4887-8bd3-8f9bf93df7e2','bf8e4e97-88e7-4b3c-bd63-d414c1256d33','2358ed02-56cf-40b3-89ad-465c35995eb9','1b4e5cab-be69-4b5a-9d46-8131ed5158a8','856d4946-54c1-4aa5-9fd6-6555a0fcdd8d','89a54fe1-6a35-4405-a5e2-f305be363035','bea1ced3-0ac3-43c7-9b80-1668ce25fde9','2444586c-1c97-49fb-b0c2-ff6f96fddba9','c8501e7f-e05e-48b0-bcd3-5c43070ee1d8','e5f47b31-66d0-4246-ab2d-5ca0529c5029','b7fdf5d4-4db0-482a-a9db-964fe6b63f4c','a0c1d9de-e395-44d1-b5bc-f24d10e1a45c','73ae8efe-8267-4d82-98e3-f8f2216b4512','b3d6c084-941d-436a-aa79-e5368019b1e3','2aa5880c-8dd4-48c7-8793-79247499bfea','2d35008d-67b2-4f6a-ba1f-55df441a76cf','398dc097-d465-4cd2-b25b-88de08332f38','eed4c5e0-8abe-412a-a1c6-ebcf8578a829','33e3ee7f-1b7e-4d39-8317-78ce092037cc','0c012000-3aeb-4fdc-91b0-fabeac63db92','f776b0e4-ba26-4066-afd1-efaa5e4b6b12','d73d1ee4-fe1a-4b4f-a3d3-4d31325ff9e3','41c52796-37b6-4778-9e1d-a57a121c6f4a','2182a114-9d62-4215-9e21-6b0f3939e318','7db22069-8574-49bd-8769-de3ecf239612','34f5fe53-7599-497d-8df3-dfc34bddb74d','ae507063-faaf-4ea2-9023-28f6f83c99ed','e8be1285-41ba-4976-9fb3-11cf6d2eb195','7595f30a-e1c0-4e5f-b889-89164620278c','b4f7ae73-2eb0-406a-a6d9-1cd49335e2cd','dc203c71-36ae-42c2-a90c-81e782b69228','f80901cc-5c06-47b7-805e-1eb0bc1b80f5','1b1b213c-8c5a-471f-91c5-181f3a110aa2','a4c1bbba-a95a-4907-96c9-c3615428d837','fc4e2812-ed5d-4352-949c-bdbb0acce2bf','459c1aef-f220-449d-8069-3a62e077fa0f','7dc4ea9d-4cc9-4207-8dbf-c9e194209f9c','eac555ca-8bf1-42ee-99c2-8eac9da624e7','662a176a-7f32-4b42-9d66-8fe59bf92b06','4109581f-c78f-4f9e-b8e0-3adf2a588797','3ee373b5-da92-4eb4-8f40-4d2e490a58e2','65888fbb-c127-4c9d-8482-3b00d7ddf380','ce18ad5d-6543-48d1-aae6-976f167c9265','39006d47-053e-4641-bbb7-4877e258c519','36550b25-66c1-4ebd-8d51-4536fd143619','5031a249-00a0-43f7-958a-62a5598e9709','6e882ac2-8d0e-4b63-bbc0-26dc310a1ffd','766bb00d-6c1f-425c-9e58-4e5d9b3298e3','6a12e62c-3b7b-4d35-8cfe-ea2617e3492b','b85853ca-d0e7-4b70-937b-0331c5cede40','7f4fafb9-48db-4e6e-8b21-24e425c3319d','a8a6ba2f-9300-465f-ad9d-879c38ce2260','ed8b2556-4a90-4be6-a393-7fb1ae15e3b7','6a4494dd-60d3-48db-ab92-735a3fb891b4','79cdafaa-24bf-4247-9d3f-d30bb8b2c1c7','1fc8d946-cdae-4435-a68a-43b18e01fb3c','ce34d689-b404-4711-8e1f-0b54ee9de957','306a9372-9284-46bd-bb1b-3170fa905356','6a8af1bc-2ab2-4b44-8799-bd22916bf445','a8bfaffe-f1f3-46e8-9bb9-26415c08b2a2','293f57f7-0b61-4526-8b1e-11a3ad0e93b1','6df71b58-acb4-4e48-bdf7-af38daa391af','da053fcd-06bf-4fcd-9037-526a83316057','4a35b90a-5039-401e-8acd-ae7b9ad298e7','62b5f7d6-8b28-4c17-90b4-1d399f4cf035','0afb6c2b-803e-4021-a966-94607c0275f5','b54bb248-2d52-46a8-b74a-61b6895a6d4d','37cb46d1-6f68-4498-bc06-ec33890418c8','f25f3c27-b19c-40ed-bdd7-4b0d97ac9f82','9ad24653-840a-4e94-a6e1-e6fe94052873','d926c9b5-c0b2-48a3-bc43-0d2c108ed9a5','7e6cd759-e054-49a2-bda3-2559e4387bab','14f9d26d-5715-4873-91ef-ba5710c566a8','56f47da7-be29-4726-8336-fb08bc14b7f9','ca014b1f-55e6-45bb-9bac-6ca8909b2f32','b127c119-73c1-44d6-bbfa-b9208b33aa6e','d1586a3b-bdf5-4288-8ea5-8941243b1252','7b0c8b41-fbad-4c7b-9f2e-f00de2415058','bfcd3595-cc5f-433a-a30c-f593bf6f37e0','d3cff435-0810-48f9-a0cf-3431964e20d0','1bdf5b7b-1ccd-4fbb-9b19-31dde30b9eca','e594ef9f-5f36-40ef-a59b-b838946e90ab','1a1bb749-33a2-43b0-b865-b4b7a05fa0a1','40aba21e-fb25-4875-ad77-3e4228151443','aef00c1c-59ef-47d4-a06f-6751965d5b06','03028687-1e1f-4fcc-b656-66e06be0562b','2d4aaa96-7912-4613-bac6-0d7c2ca7bb3f','1f292a52-f6b1-4328-9174-4dff0c95261c','fe5a397a-243c-416a-84c8-792726777de3','fba5ca35-0bc3-4740-9362-2dfef2013717','a4477697-7aa4-4bd0-9404-4a47fad34374','6c329de5-6468-401d-b51f-04ed9b4a5e3d','fe5708c9-cecb-4117-a222-d435762150da','c5eec653-2d09-4caf-9d1d-5747bed42ca1','758d3d3e-a9f7-4176-b3b6-9d1933cb88bc','4c13c056-49e2-44a2-8fb9-debbc8782f80','946ae76f-7276-46cc-b19c-83555cb5542b','248fb905-40c0-4bff-8dab-e4de9e780b15','4675121f-a35f-4b80-868d-d6bc6bc7dbbd','0434a3e7-120a-4280-8198-f942a48ac9e4','b01b390f-e4c9-4c64-99f8-af8279910320','6b9756a8-a726-4b1b-af98-5ae1c6640aaf','112ca0ba-1886-455e-94ec-9abb3b5b74c8','ee1cfb0e-4774-452d-9257-43a704cee211','27fe6639-c20d-4da0-bc94-55734bfe624b','777ad733-d09a-4af4-a5d5-386a20abcf09','c5b2a4fc-e885-428d-9580-c8c60c9e9a3c','e74e2bd3-c419-4695-b909-acbc3b7caca1','c44d74d4-b953-47b9-871b-85d49c6f23f8','46457171-7a5d-49ad-9d3b-134558487808')

  user_profile:
    parameters: SELECT request.user_id() AS profile_id
    data:
      #   - SELECT * FROM "profile" WHERE "profile".id = bucket.profile_id
      - SELECT * FROM "project" WHERE bucket.profile_id in download_profiles
      - SELECT * FROM "quest" WHERE bucket.profile_id in download_profiles
      - SELECT * FROM "asset" WHERE bucket.profile_id in download_profiles
      - SELECT * FROM "asset_content_link" WHERE bucket.profile_id in download_profiles
      - SELECT * FROM "project_language_link" WHERE bucket.profile_id in download_profiles
      - SELECT asset_id || '_' || tag_id as id, * FROM "asset_tag_link" WHERE bucket.profile_id in download_profiles
      - SELECT * FROM "language" WHERE bucket.profile_id in download_profiles
      - SELECT * FROM "quest_closure" WHERE bucket.profile_id in download_profiles
      - SELECT * FROM "project_closure" WHERE bucket.profile_id in download_profiles
      - SELECT quest_id || '_' || asset_id as id, * FROM "quest_asset_link" WHERE bucket.profile_id in download_profiles
      - SELECT quest_id || '_' || tag_id as id, * FROM "quest_tag_link" WHERE bucket.profile_id in download_profiles
      - SELECT * FROM "tag" WHERE bucket.profile_id in download_profiles
      - SELECT * FROM "vote" WHERE bucket.profile_id in download_profiles

      - SELECT
        *
        FROM reports
        WHERE "reports".reporter_id = bucket.profile_id

      - SELECT
        blocker_id || '_' || blocked_id as id,
        *
        FROM blocked_users
        WHERE "blocked_users".blocker_id = bucket.profile_id

      - SELECT
        *
        FROM blocked_content
        WHERE "blocked_content".profile_id = bucket.profile_id

      - SELECT * FROM notification
        WHERE profile_id = bucket.profile_id

      - SELECT * FROM subscription
        WHERE profile_id = bucket.profile_id

      - SELECT * FROM invite
        WHERE sender_profile_id = bucket.profile_id
        OR receiver_profile_id = bucket.profile_id

      - SELECT * FROM request
        WHERE sender_profile_id = bucket.profile_id

  project_memberships:
    parameters: |
      SELECT project_id FROM profile_project_link
      WHERE profile_id = request.user_id()
        AND membership IS NOT NULL
    data:
      - SELECT profile_id || '_' || project_id as id, * FROM profile_project_link
        WHERE project_id = bucket.project_id
        AND membership IS NOT NULL

      - SELECT * FROM invite
        WHERE project_id = bucket.project_id

  project_ownerships:
    parameters: |
      SELECT project_id FROM profile_project_link
      WHERE profile_id = request.user_id()
        AND membership = 'owner'
    data:
      - SELECT * FROM request
        WHERE project_id = bucket.project_id
